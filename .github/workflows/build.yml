name: Build TF

on:
  push:

jobs:
  windows:
    runs-on: windows-latest

    steps:
    - name: Checkout The-Forge
      uses: actions/checkout@v3
      with:
        path: The-Forge
      
    - name: Checkout Custom-Middleware
      uses: actions/checkout@v3
      with:
        path: Custom-Middleware

    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    - name: Install VS2017
      run: choco install VisualStudio2017Community visualstudio2017-workload-nativedesktop
        
    - name: Setup MSBuild
      uses: microsoft/setup-msbuild@v1.1
      with:
        vs-version: '[15.0,16.0)'

    - name: Build
      working-directory: The-Forge
      shell: cmd
      run: python -u ./CI/PyBuild.py --preserveworkingdir --printbuildoutput
      
  macOS:
    runs-on: macos-latest

    steps:
    - name: Checkout The-Forge
      uses: actions/checkout@v3
      with:
        path: The-Forge
      
    - name: Checkout Custom-Middleware
      uses: actions/checkout@v3
      with:
        path: Custom-Middleware

    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: Build
      working-directory: The-Forge
      run: python -u ./CI/PyBuild.py --preserveworkingdir --printbuildoutput

      
  ubuntu:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout The-Forge
      uses: actions/checkout@v3
      with:
        path: The-Forge
      
    - name: Checkout Custom-Middleware
      uses: actions/checkout@v3
      with:
        path: Custom-Middleware

    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: Build
      working-directory: The-Forge
      run: python -u ./CI/PyBuild.py --preserveworkingdir --printbuildoutput
      
